{"version":3,"sources":["../src/server.ts"],"sourcesContent":["import { Pool } from \"pg\";\nimport { RetoolDatabaseOptions } from \"./types\";\n\nexport async function queryRetoolDatabase<T>(\n  tableName: string,\n  options?: RetoolDatabaseOptions,\n) {\n  const pool = new Pool({\n    connectionString: process.env.RETOOL_DATABASE_URL,\n  });\n\n  try {\n    if (options?.query) {\n      const result = await pool.query({\n        text: options.query,\n        values: options.params || [],\n      });\n      return result.rows as T[];\n    }\n\n    const result = await pool.query({\n      text: `SELECT * FROM \"${tableName}\" LIMIT $1`,\n      values: [options?.limit || 100],\n    });\n    return result.rows as T[];\n  } catch (error) {\n    throw error;\n  } finally {\n    await pool.end();\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,SAAS,YAAY;AAGrB,SAAsB,oBACpB,WACA,SACA;AAAA;AACA,UAAM,OAAO,IAAI,KAAK;AAAA,MACpB,kBAAkB,QAAQ,IAAI;AAAA,IAChC,CAAC;AAED,QAAI;AACF,UAAI,mCAAS,OAAO;AAClB,cAAMA,UAAS,MAAM,KAAK,MAAM;AAAA,UAC9B,MAAM,QAAQ;AAAA,UACd,QAAQ,QAAQ,UAAU,CAAC;AAAA,QAC7B,CAAC;AACD,eAAOA,QAAO;AAAA,MAChB;AAEA,YAAM,SAAS,MAAM,KAAK,MAAM;AAAA,QAC9B,MAAM,kBAAkB,SAAS;AAAA,QACjC,QAAQ,EAAC,mCAAS,UAAS,GAAG;AAAA,MAChC,CAAC;AACD,aAAO,OAAO;AAAA,IAChB,SAAS,OAAO;AACd,YAAM;AAAA,IACR,UAAE;AACA,YAAM,KAAK,IAAI;AAAA,IACjB;AAAA,EACF;AAAA;","names":["result"]}